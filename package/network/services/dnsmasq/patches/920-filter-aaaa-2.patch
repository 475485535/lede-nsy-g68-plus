Index: dnsmasq-2.80/src/rfc1035.c
===================================================================
--- dnsmasq-2.80.orig/src/rfc1035.c
+++ dnsmasq-2.80/src/rfc1035.c
@@ -1898,10 +1898,13 @@ size_t answer_request(struct dns_header
 
       //patch to filter aaaa forwards
       if (qtype == T_AAAA && option_bool(OPT_FILTER_AAAA) ){
-        //return a null reply
-        ans = 1;
-        if (!dryrun) log_query(F_CONFIG | F_IPV6 | F_NEG, name, &addr, NULL);
-        break;
+        //check ipv4 record from cache(wybb)
+        struct crec* queryIpv4 = cache_find_by_name(NULL, name, now, F_IPV4);
+        if(queryIpv4 && !(queryIpv4->flags & F_NEG)){
+          ans = 1;
+          if (!dryrun) log_query(F_CONFIG | F_IPV6 | F_NEG, name, &addr, NULL);
+          break;
+        }
       }
       //end of patch
 
